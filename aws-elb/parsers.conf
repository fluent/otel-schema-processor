[PARSER]
    Name   aws-elb
    Format regex
    Regex  ^(?<request_type>[^ ]*) (?<timestamp>[^ ]*) (?<elb>[^ ]*) (?<client_ip>[^ ]*):(?<client_port>[0-9]*) (?<target_ip>[^ ]*)[:-](?<target_port>[0-9]*) (?<request_processing_time>[-.0-9]*) (?<target_processing_time>[-.0-9]*) (?<response_processing_time>[-.0-9]*) (?<elb_status_code>|[-0-9]*) (?<target_status_code>-|[-0-9]*) (?<received_bytes>[-0-9]*) (?<sent_bytes>[-0-9]*) \"(?<request>(-|(?<http_method>\w+)) (-|(?<http_protocol>\w*)://\[?(?<http_host>[^/]+?)\]?:(?<http_port>\d+)(-|(?<http_path>/[^?]*?))(\?(?<http_query>.*?))?) (-?|\w+/(?<http_version>[0-9\.]*)))\" \"(|(?<useragent>[^\"]+))\" (?<ssl_cipher>[()A-Z0-9-]+) (?<ssl_protocol>[A-Za-z0-9.-]*) (?<target_group_arn>[^ ]*) \"(?<trace_id>[^\"]*)\" \"(?<domain_name>[^\"]*)\" \"(?<chosen_cert_arn>[^\"]*)\" (?<matched_rule_priority>[-.0-9]*) (?<request_creation_time>[^ ]*) \"(?<actions_executed>[^\"]*)\" \"(?<redirect_url>[^\"]*)\" \"(?<lambda_error_reason>[^ ]*)\" \"(?<target_port_list>[^\s]+)\" \"(?<target_status_code_list>[^\s]+)\"( \"(?<classification>[^\s]+)\" \"(?<classification_reason>[^\s]+)\")?
    Time_Key time
    Time_Format %d/%b/%Y:%H:%M:%S %z